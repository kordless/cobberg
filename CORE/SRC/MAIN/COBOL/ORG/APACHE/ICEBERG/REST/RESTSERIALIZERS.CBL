IDENTIFICATION DIVISION.
PROGRAM-ID. REST-SERIALIZERS.

ENVIRONMENT DIVISION.
REPOSITORY.
    COPY ICEBERG-COPYBOOK.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-MAPPER OBJECT.
01 WS-MODULE OBJECT.
01 WS-ERROR-RESPONSE OBJECT.
01 WS-TABLE-IDENTIFIER OBJECT.
01 WS-NAMESPACE OBJECT.
01 WS-SCHEMA OBJECT.
01 WS-UNBOUND-PARTITION-SPEC OBJECT.
01 WS-UNBOUND-SORT-ORDER OBJECT.
01 WS-METADATA-UPDATE OBJECT.
01 WS-TABLE-METADATA OBJECT.
01 WS-UPDATE-REQUIREMENT OBJECT.
01 WS-OAUTH-TOKEN-RESPONSE OBJECT.
01 WS-REPORT-METRICS-REQUEST OBJECT.
01 WS-COMMIT-TRANSACTION-REQUEST OBJECT.
01 WS-UPDATE-TABLE-REQUEST OBJECT.
01 WS-REGISTER-TABLE-REQUEST OBJECT.
01 WS-CREATE-VIEW-REQUEST OBJECT.
01 WS-LOAD-VIEW-RESPONSE OBJECT.
01 WS-CONFIG-RESPONSE OBJECT.
01 WS-LOAD-TABLE-RESPONSE OBJECT.
01 WS-LOAD-CREDENTIALS-RESPONSE OBJECT.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    CALL "REGISTER-ALL" USING WS-MAPPER.
    
    STOP RUN.

IDENTIFICATION DIVISION.
PROGRAM-ID. REGISTER-ALL.
ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT OPTIONAL ICEBERG-CONFIG
        ORGANIZATION IS LINE-SEQUENTIAL
        ACCESS MODE IS SEQUENTIAL
        FILE STATUS IS WS-FILE-STATUS.
DATA DIVISION.
FILE SECTION.
FD  ICEBERG-CONFIG.
01  ICEBERG-CONFIG-RECORD PIC X(80).

PROCEDURE DIVISION USING WS-MAPPER.
MAIN-PROCEDURE.
    PERFORM REGISTER-SERIALIZERS.
    STOP RUN.
    
REGISTER-SERIALIZERS.
    PERFORM REGISTER-ERROR-RESPONSE.
    PERFORM REGISTER-TABLE-IDENTIFIER.
    PERFORM REGISTER-NAMESPACE.
    PERFORM REGISTER-SCHEMA.
    PERFORM REGISTER-UNBOUND-PARTITION-SPEC.
    PERFORM REGISTER-UNBOUND-SORT-ORDER.
    PERFORM REGISTER-METADATA-UPDATE.
    PERFORM REGISTER-TABLE-METADATA.
    PERFORM REGISTER-UPDATE-REQUIREMENT.
    PERFORM REGISTER-OAUTH-TOKEN-RESPONSE.
    PERFORM REGISTER-REPORT-METRICS-REQUEST.
    PERFORM REGISTER-COMMIT-TRANSACTION-REQUEST.
    PERFORM REGISTER-UPDATE-TABLE-REQUEST.
    PERFORM REGISTER-REGISTER-TABLE-REQUEST.
    PERFORM REGISTER-CREATE-VIEW-REQUEST.
    PERFORM REGISTER-LOAD-VIEW-RESPONSE.
    PERFORM REGISTER-CONFIG-RESPONSE.
    PERFORM REGISTER-LOAD-TABLE-RESPONSE.
    PERFORM REGISTER-LOAD-CREDENTIALS-RESPONSE.
    
REGISTER-ERROR-RESPONSE.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-ERROR-RESPONSE.
    
REGISTER-TABLE-IDENTIFIER.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-TABLE-IDENTIFIER.
    
REGISTER-NAMESPACE.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-NAMESPACE.
    
REGISTER-SCHEMA.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-SCHEMA.
    
REGISTER-UNBOUND-PARTITION-SPEC.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-UNBOUND-PARTITION-SPEC.
    
REGISTER-UNBOUND-SORT-ORDER.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-UNBOUND-SORT-ORDER.
    
REGISTER-METADATA-UPDATE.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-METADATA-UPDATE.
    
REGISTER-TABLE-METADATA.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-TABLE-METADATA.
    
REGISTER-UPDATE-REQUIREMENT.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-UPDATE-REQUIREMENT.
    
REGISTER-OAUTH-TOKEN-RESPONSE.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-OAUTH-TOKEN-RESPONSE.
    
REGISTER-REPORT-METRICS-REQUEST.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-REPORT-METRICS-REQUEST.
    
REGISTER-COMMIT-TRANSACTION-REQUEST.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-COMMIT-TRANSACTION-REQUEST.
    
REGISTER-UPDATE-TABLE-REQUEST.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-UPDATE-TABLE-REQUEST.
    
REGISTER-REGISTER-TABLE-REQUEST.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-REGISTER-TABLE-REQUEST.
    
REGISTER-CREATE-VIEW-REQUEST.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-CREATE-VIEW-REQUEST.
    
REGISTER-LOAD-VIEW-RESPONSE.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-LOAD-VIEW-RESPONSE.
    
REGISTER-CONFIG-RESPONSE.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-CONFIG-RESPONSE.
    
REGISTER-LOAD-TABLE-RESPONSE.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-LOAD-TABLE-RESPONSE.
    
REGISTER-LOAD-CREDENTIALS-RESPONSE.
    CALL "REGISTER-MODULE" USING WS-MAPPER, WS-LOAD-CREDENTIALS-RESPONSE.