IDENTIFICATION DIVISION.
PROGRAM-ID. VALUE-WRITERS.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 NULL-INDEX PIC 9 VALUE 0.
01 VALUE-INDEX PIC 9 VALUE 1.
01 BUFFER-LENGTH PIC 9(4) VALUE 16.

LINKAGE SECTION.
01 VOID-VALUE                    USAGE POINTER.
01 BOOLEAN-VALUE                 PIC X.
01 BYTE-VALUE                    PIC S9(4) COMP.
01 SHORT-VALUE                   PIC S9(4) COMP.
01 INTEGER-VALUE                 PIC S9(9) COMP.
01 LONG-VALUE                    PIC S9(18) COMP.
01 FLOAT-VALUE                   USAGE FLOAT-LONG.
01 DOUBLE-VALUE                  USAGE FLOAT-DOUBLE.
01 STRING-VALUE                  PIC X(512).
01 UTF8-VALUE                    PIC X(512).
01 UUID-VALUE                    PIC X(16).
01 FIXED-VALUE                   PIC X(256).
01 GENERIC-FIXED-VALUE           PIC X(256).
01 BYTE-BUFFER-VALUE             PIC X(256).
01 DECIMAL-VALUE                 PIC S9(18)V9(18) COMP-3.
01 COLLECTION-VALUE              OCCURS 1 TO 32767 TIMES DEPENDING ON COLLECTION-SIZE PIC X(512).
01 COLLECTION-SIZE               PIC 9(5) COMP.
01 MAP-VALUE.
   05 MAP-ENTRY OCCURS 1 TO 32767 TIMES DEPENDING ON MAP-SIZE.
      10 MAP-KEY                 PIC X(512).
      10 MAP-VALUE                PIC X(512).
01 MAP-SIZE                      PIC 9(5) COMP.
01 RECORD-VALUE.
   05 RECORD-FIELD OCCURS 1 TO 32767 TIMES DEPENDING ON RECORD-SIZE PIC X(512).
01 RECORD-SIZE                   PIC 9(5) COMP.
01 STRUCT-VALUE.
   05 STRUCT-FIELD OCCURS 1 TO 32767 TIMES DEPENDING ON STRUCT-SIZE PIC X(512).
01 STRUCT-SIZE                   PIC 9(5) COMP.

PROCEDURE DIVISION.

IDENTIFICATION DIVISION.
PROGRAM-ID. NULLS-WRITER.
PROCEDURE DIVISION USING VOID-VALUE, ENCODER.
    CALL "ENCODE-NULL" USING ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. BOOLEANS-WRITER.
PROCEDURE DIVISION USING BOOLEAN-VALUE, ENCODER.
    CALL "ENCODE-BOOLEAN" USING BOOLEAN-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. TINYINTS-WRITER.
PROCEDURE DIVISION USING BYTE-VALUE, ENCODER.
    CALL "ENCODE-INT" USING BYTE-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. SHORTS-WRITER.
PROCEDURE DIVISION USING SHORT-VALUE, ENCODER.
    CALL "ENCODE-INT" USING SHORT-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. INTS-WRITER.
PROCEDURE DIVISION USING INTEGER-VALUE, ENCODER.
    CALL "ENCODE-INT" USING INTEGER-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. LONGS-WRITER.
PROCEDURE DIVISION USING LONG-VALUE, ENCODER.
    CALL "ENCODE-LONG" USING LONG-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. FLOATS-WRITER.
PROCEDURE DIVISION USING FLOAT-VALUE, ENCODER.
    CALL "ENCODE-FLOAT" USING FLOAT-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. DOUBLES-WRITER.
PROCEDURE DIVISION USING DOUBLE-VALUE, ENCODER.
    CALL "ENCODE-DOUBLE" USING DOUBLE-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. STRINGS-WRITER.
PROCEDURE DIVISION USING STRING-VALUE, ENCODER.
    CALL "ENCODE-STRING" USING STRING-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. UTF8S-WRITER.
PROCEDURE DIVISION USING UTF8-VALUE, ENCODER.
    CALL "ENCODE-STRING" USING UTF8-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. UUIDS-WRITER.
PROCEDURE DIVISION USING UUID-VALUE, ENCODER.
    CALL "ENCODE-FIXED" USING UUID-VALUE, BUFFER-LENGTH, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. FIXED-WRITER.
PROCEDURE DIVISION USING FIXED-VALUE, ENCODER.
    CALL "ENCODE-FIXED" USING FIXED-VALUE, LENGTH OF FIXED-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. GENERIC-FIXED-WRITER.
PROCEDURE DIVISION USING GENERIC-FIXED-VALUE, ENCODER.
    CALL "ENCODE-FIXED" USING GENERIC-FIXED-VALUE, LENGTH OF GENERIC-FIXED-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. FIXED-BYTE-BUFFER-WRITER.
PROCEDURE DIVISION USING BYTE-BUFFER-VALUE, ENCODER.
    CALL "ENCODE-BYTES" USING BYTE-BUFFER-VALUE, LENGTH OF BYTE-BUFFER-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. BYTES-WRITER.
PROCEDURE DIVISION USING BYTE-BUFFER-VALUE, ENCODER.
    CALL "ENCODE-BYTES" USING BYTE-BUFFER-VALUE, LENGTH OF BYTE-BUFFER-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. BYTE-BUFFER-WRITER.
PROCEDURE DIVISION USING BYTE-BUFFER-VALUE, ENCODER.
    CALL "ENCODE-BYTES" USING BYTE-BUFFER-VALUE, LENGTH OF BYTE-BUFFER-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. DECIMAL-WRITER.
PROCEDURE DIVISION USING DECIMAL-VALUE, ENCODER.
    CALL "ENCODE-FIXED" USING DECIMAL-VALUE, LENGTH OF DECIMAL-VALUE, ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. OPTION-WRITER.
PROCEDURE DIVISION USING VOID-VALUE, ENCODER.
    IF VOID-VALUE = NULL THEN
        CALL "ENCODE-INDEX" USING NULL-INDEX, ENCODER
    ELSE
        CALL "ENCODE-INDEX" USING VALUE-INDEX, ENCODER
        CALL "WRITE-VALUE" USING VOID-VALUE, ENCODER
    END-IF.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. COLLECTION-WRITER.
PROCEDURE DIVISION USING COLLECTION-VALUE, COLLECTION-SIZE, ENCODER.
    CALL "ENCODE-ARRAY-START" USING ENCODER.
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > COLLECTION-SIZE
        CALL "ENCODE-ARRAY-ITEM-START" USING ENCODER
        CALL "WRITE-VALUE" USING COLLECTION-VALUE(I), ENCODER
    END-PERFORM.
    CALL "ENCODE-ARRAY-END" USING ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. ARRAY-MAP-WRITER.
PROCEDURE DIVISION USING MAP-VALUE, MAP-SIZE, ENCODER.
    CALL "ENCODE-ARRAY-START" USING ENCODER.
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > MAP-SIZE
        CALL "ENCODE-ARRAY-ITEM-START" USING ENCODER
        CALL "WRITE-VALUE" USING MAP-KEY(I), ENCODER
        CALL "WRITE-VALUE" USING MAP-VALUE(I), ENCODER
    END-PERFORM.
    CALL "ENCODE-ARRAY-END" USING ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. MAP-WRITER.
PROCEDURE DIVISION USING MAP-VALUE, MAP-SIZE, ENCODER.
    CALL "ENCODE-MAP-START" USING ENCODER.
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > MAP-SIZE
        CALL "ENCODE-MAP-ITEM-START" USING ENCODER
        CALL "WRITE-VALUE" USING MAP-KEY(I), ENCODER
        CALL "WRITE-VALUE" USING MAP-VALUE(I), ENCODER
    END-PERFORM.
    CALL "ENCODE-MAP-END" USING ENCODER.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. RECORD-WRITER.
PROCEDURE DIVISION USING RECORD-VALUE, RECORD-SIZE, ENCODER.
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > RECORD-SIZE
        CALL "WRITE-VALUE" USING RECORD-FIELD(I), ENCODER
    END-PERFORM.
    EXIT PROGRAM.

IDENTIFICATION DIVISION.
PROGRAM-ID. STRUCT-WRITER.
PROCEDURE DIVISION USING STRUCT-VALUE, STRUCT-SIZE, ENCODER.
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > STRUCT-SIZE
        CALL "WRITE-VALUE" USING STRUCT-FIELD(I), ENCODER
    END-PERFORM.
    EXIT PROGRAM.