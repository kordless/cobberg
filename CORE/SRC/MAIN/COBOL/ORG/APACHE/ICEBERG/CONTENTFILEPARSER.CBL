IDENTIFICATION DIVISION.
PROGRAM-ID. CONTENT-FILE-PARSER.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 SPEC-ID                     PIC X(10).
01 CONTENT                     PIC X(20).
01 FILE-PATH                   PIC X(100).
01 FILE-FORMAT                 PIC X(20).
01 PARTITION                   PIC X(100).
01 RECORD-COUNT                PIC 9(18).
01 FILE-SIZE                   PIC 9(18).
01 COLUMN-SIZES                PIC X(100).
01 VALUE-COUNTS                PIC X(100).
01 NULL-VALUE-COUNTS           PIC X(100).
01 NAN-VALUE-COUNTS            PIC X(100).
01 LOWER-BOUNDS                PIC X(100).
01 UPPER-BOUNDS                PIC X(100).
01 KEY-METADATA                PIC X(100).
01 SPLIT-OFFSETS               PIC X(100).
01 EQUALITY-IDS                PIC X(100).
01 SORT-ORDER-ID               PIC 9(9).
01 REFERENCED-DATA-FILE        PIC X(100).
01 CONTENT-OFFSET              PIC 9(18).
01 CONTENT-SIZE                PIC 9(18).

PROCEDURE DIVISION.

MAIN-PARAGRAPH.
    PERFORM HAS-PARTITION-DATA
    PERFORM TO-JSON
    PERFORM FROM-JSON
    STOP RUN.

HAS-PARTITION-DATA.
    IF PARTITION IS NOT EQUAL TO SPACES
        AND PARTITION-SIZE IS GREATER THAN 0
        MOVE "PARTITIONED" TO PARTITION-TYPE
    ELSE
        MOVE "UNPARTITIONED" TO PARTITION-TYPE.

TO-JSON.
    WRITE CONTENT-FILE-JSON FROM CONTENT-FILE, PARTITION-SPEC.

FROM-JSON.
    MOVE CONTENT-FILE-JSON TO CONTENT-FILE
    MOVE PARTITION-SPEC TO PARTITION-SPEC.

COPY "SINGLE-VALUE-PARSER.cpy".
COPY "METRICS.cpy".