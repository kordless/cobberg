IDENTIFICATION DIVISION.
PROGRAM-ID. CHECK-COMPATIBILITY.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-NO-ERRORS        PIC X(999) VALUE 'NO_ERRORS'.
01 WS-ERRORS           PIC X(999) VALUE SPACES.
01 WS-CURRENT-TYPE     PIC X(50) VALUE SPACES.
01 WS-CHECK-ORDERING   PIC X VALUE 'Y'.
01 WS-CHECK-NULLABILITY PIC X VALUE 'Y'.

LINKAGE SECTION.
01 LNK-READ-SCHEMA     PIC X(99).
01 LNK-WRITE-SCHEMA    PIC X(99).

PROCEDURE DIVISION USING LNK-READ-SCHEMA, LNK-WRITE-SCHEMA.

    MOVE FUNCTION TRIM(LNK-READ-SCHEMA) TO WS-READ-SCHEMA.
    MOVE FUNCTION TRIM(LNK-WRITE-SCHEMA) TO WS-WRITE-SCHEMA.

    PERFORM CHECK-WRITE-COMPATIBILITY.
    PERFORM CHECK-TYPE-COMPATIBILITY.
    PERFORM CHECK-READ-COMPATIBILITY.

    DISPLAY WS-ERRORS.
    STOP RUN.

CHECK-WRITE-COMPATIBILITY SECTION.
    CALL 'WRITE-COMPATIBILITY-ERRORS' USING WS-READ-SCHEMA, WS-WRITE-SCHEMA, WS-CHECK-ORDERING, WS-CHECK-NULLABILITY.
    IF WS-ERRORS = WS-NO-ERRORS
        DISPLAY 'No write compatibility errors'
    ELSE
        DISPLAY 'Write compatibility errors: ' WS-ERRORS
    END-IF.

CHECK-TYPE-COMPATIBILITY SECTION.
    CALL 'TYPE-COMPATIBILITY-ERRORS' USING WS-READ-SCHEMA, WS-WRITE-SCHEMA, WS-CHECK-ORDERING.
    IF WS-ERRORS = WS-NO-ERRORS
        DISPLAY 'No type compatibility errors'
    ELSE
        DISPLAY 'Type compatibility errors: ' WS-ERRORS
    END-IF.

CHECK-READ-COMPATIBILITY SECTION.
    CALL 'READ-COMPATIBILITY-ERRORS' USING WS-READ-SCHEMA, WS-WRITE-SCHEMA.
    IF WS-ERRORS = WS-NO-ERRORS
        DISPLAY 'No read compatibility errors'
    ELSE
        DISPLAY 'Read compatibility errors: ' WS-ERRORS
    END-IF.

IDENTIFICATION DIVISION.
PROGRAM-ID. WRITE-COMPATIBILITY-ERRORS.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-READ-SCHEMA      PIC X(99).
01 WS-WRITE-SCHEMA     PIC X(99).
01 WS-CHECK-ORDERING   PIC X VALUE 'Y'.
01 WS-CHECK-NULLABILITY PIC X VALUE 'Y'.
01 WS-ERRORS           PIC X(999) VALUE SPACES.

LINKAGE SECTION.
01 LNK-READ-SCHEMA     PIC X(99).
01 LNK-WRITE-SCHEMA    PIC X(99).
01 LNK-CHECK-ORDERING  PIC X.
01 LNK-CHECK-NULLABILITY PIC X.

PROCEDURE DIVISION USING LNK-READ-SCHEMA, LNK-WRITE-SCHEMA, LNK-CHECK-ORDERING, LNK-CHECK-NULLABILITY.

    MOVE FUNCTION TRIM(LNK-READ-SCHEMA) TO WS-READ-SCHEMA.
    MOVE FUNCTION TRIM(LNK-WRITE-SCHEMA) TO WS-WRITE-SCHEMA.
    MOVE LNK-CHECK-ORDERING TO WS-CHECK-ORDERING.
    MOVE LNK-CHECK-NULLABILITY TO WS-CHECK-NULLABILITY.

    PERFORM WRITE-COMPATIBILITY-CHECK.

    MOVE WS-ERRORS TO RETURN-CODE.
    GOBACK.

WRITE-COMPATIBILITY-CHECK SECTION.
    * Implement write compatibility check logic here
    IF WS-ERRORS = SPACES
        MOVE 'NO_ERRORS' TO WS-ERRORS
    END-IF.

IDENTIFICATION DIVISION.
PROGRAM-ID. TYPE-COMPATIBILITY-ERRORS.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-READ-SCHEMA      PIC X(99).
01 WS-WRITE-SCHEMA     PIC X(99).
01 WS-CHECK-ORDERING   PIC X VALUE 'Y'.
01 WS-ERRORS           PIC X(999) VALUE SPACES.

LINKAGE SECTION.
01 LNK-READ-SCHEMA     PIC X(99).
01 LNK-WRITE-SCHEMA    PIC X(99).
01 LNK-CHECK-ORDERING  PIC X.

PROCEDURE DIVISION USING LNK-READ-SCHEMA, LNK-WRITE-SCHEMA, LNK-CHECK-ORDERING.

    MOVE FUNCTION TRIM(LNK-READ-SCHEMA) TO WS-READ-SCHEMA.
    MOVE FUNCTION TRIM(LNK-WRITE-SCHEMA) TO WS-WRITE-SCHEMA.
    MOVE LNK-CHECK-ORDERING TO WS-CHECK-ORDERING.

    PERFORM TYPE-COMPATIBILITY-CHECK.

    MOVE WS-ERRORS TO RETURN-CODE.
    GOBACK.

TYPE-COMPATIBILITY-CHECK SECTION.
    * Implement type compatibility check logic here
    IF WS-ERRORS = SPACES
        MOVE 'NO_ERRORS' TO WS-ERRORS
    END-IF.

IDENTIFICATION DIVISION.
PROGRAM-ID. READ-COMPATIBILITY-ERRORS.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-READ-SCHEMA      PIC X(99).
01 WS-WRITE-SCHEMA     PIC X(99).
01 WS-ERRORS           PIC X(999) VALUE SPACES.

LINKAGE SECTION.
01 LNK-READ-SCHEMA     PIC X(99).
01 LNK-WRITE-SCHEMA    PIC X(99).

PROCEDURE DIVISION USING LNK-READ-SCHEMA, LNK-WRITE-SCHEMA.

    MOVE FUNCTION TRIM(LNK-READ-SCHEMA) TO WS-READ-SCHEMA.
    MOVE FUNCTION TRIM(LNK-WRITE-SCHEMA) TO WS-WRITE-SCHEMA.

    PERFORM READ-COMPATIBILITY-CHECK.

    MOVE WS-ERRORS TO RETURN-CODE.
    GOBACK.

READ-COMPATIBILITY-CHECK SECTION.
    * Implement read compatibility check logic here
    IF WS-ERRORS = SPACES
        MOVE 'NO_ERRORS' TO WS-ERRORS
    END-IF.