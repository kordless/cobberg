IDENTIFICATION DIVISION.
PROGRAM-ID. ICEBERG-CATALOG.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-TABLE-IDENTIFIER.
   03 WS-NAMESPACE             PIC X(32).
   03 WS-TABLE-NAME            PIC X(32).
01 WS-SCHEMA                   PIC X(1024).
01 WS-PARTITION-SPEC           PIC X(1024).
01 WS-LOCATION                 PIC X(256).
01 WS-PROPERTIES               PIC X(1024).
01 WS-SORT-ORDER               PIC X(1024).

PROCEDURE DIVISION.

CATALOG-NAME.
    MOVE FUNCTION CURRENT-DATE TO WS-RETURN-CODE.
    DISPLAY 'Catalog name: ' WS-RETURN-CODE.

LIST-TABLES.
    MOVE WS-NAMESPACE TO WS-RETURN-CODE.
    DISPLAY 'Listing tables in namespace: ' WS-RETURN-CODE.
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > 10
        MOVE 'TABLE-' TO WS-TABLE-NAME
        MOVE I TO WS-TABLE-NAME(7:2)
        DISPLAY 'Table identifier: ' WS-NAMESPACE '/' WS-TABLE-NAME
    END-PERFORM.

CREATE-TABLE.
    MOVE WS-TABLE-IDENTIFIER TO WS-RETURN-CODE.
    DISPLAY 'Creating table: ' WS-RETURN-CODE.
    MOVE WS-SCHEMA TO WS-RETURN-CODE.
    DISPLAY 'Schema: ' WS-RETURN-CODE.
    MOVE WS-PARTITION-SPEC TO WS-RETURN-CODE.
    DISPLAY 'Partition spec: ' WS-RETURN-CODE.
    MOVE WS-LOCATION TO WS-RETURN-CODE.
    DISPLAY 'Location: ' WS-RETURN-CODE.
    MOVE WS-PROPERTIES TO WS-RETURN-CODE.
    DISPLAY 'Properties: ' WS-RETURN-CODE.
    CALL 'CREATE-TABLE' USING WS-TABLE-IDENTIFIER, WS-SCHEMA, WS-PARTITION-SPEC, WS-LOCATION, WS-PROPERTIES.

LOAD-TABLE.
    MOVE WS-TABLE-IDENTIFIER TO WS-RETURN-CODE.
    DISPLAY 'Loading table: ' WS-RETURN-CODE.
    CALL 'LOAD-TABLE' USING WS-TABLE-IDENTIFIER.

DROP-TABLE.
    MOVE WS-TABLE-IDENTIFIER TO WS-RETURN-CODE.
    DISPLAY 'Dropping table: ' WS-RETURN-CODE.
    CALL 'DROP-TABLE' USING WS-TABLE-IDENTIFIER, 'TRUE'.

RENAME-TABLE.
    MOVE WS-TABLE-IDENTIFIER TO WS-RETURN-CODE.
    DISPLAY 'Renaming table from: ' WS-RETURN-CODE.
    MOVE 'NEW-TABLE-NAME' TO WS-RETURN-CODE.
    DISPLAY 'Renaming table to: ' WS-RETURN-CODE.
    CALL 'RENAME-TABLE' USING WS-TABLE-IDENTIFIER, 'NEW-TABLE-NAME'.

STOP RUN.