IDENTIFICATION DIVISION.
PROGRAM-ID. RESIDUAL-EVALUATOR.

ENVIRONMENT DIVISION.
REPOSITORY.
    COPY ICEBERG-EXPRESSIONS.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-SPEC                  USAGE POINTER.
01 WS-EXPR                  USAGE POINTER.
01 WS-CASE-SENSITIVE        PIC X(01) VALUE 'Y'.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    PERFORM INITIALIZE-EVALUATOR
    PERFORM RESIDUAL-FOR-PARTITION
    STOP RUN.

INITIALIZE-EVALUATOR.
    CALL "COPY" USING ICEBERG-EXPRESSIONS, WS-SPEC, WS-EXPR, WS-CASE-SENSITIVE.

RESIDUAL-FOR-PARTITION.
    CALL "RESIDUAL-FOR" USING WS-SPEC, WS-EXPR, WS-CASE-SENSITIVE.

END PROGRAM RESIDUAL-EVALUATOR.